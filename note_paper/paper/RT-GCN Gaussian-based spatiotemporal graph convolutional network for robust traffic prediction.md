# RT-GCN: Gaussian-based spatiotemporal graph convolutional network for robust traffic prediction

RT-GCN: 基于高斯的时空图卷积网络用于鲁棒交通预测



## 摘要

*Traffic forecasting plays a critical role in intelligent transportation systems (ITS) in smart cities. Travelers as well as urban managers rely on reliable traffic information to make their decisions for route choice and traffic management. However, noisy or missing traffic data poses a problem for accurate and robust traffic forecasting. While data-driven models such as deep neural networks can achieve high prediction accuracy with complete datasets, sensor malfunctions, and environmental effects degrade the performance of such models, as these models rely heavily on precise traffic measurements for model training and estimation. Consequently, incomplete traffic data poses a challenge for robust model design that can make accurate traffic forecasts with noisy/missing data. This research proposes the Robust Spatiotemporal Graph Convolutional Network (RT-GCN), a traffic prediction model that handles noise perturbations and missing data using a Gaussian distributed node representation and a variance based attention mechanism. Through experiments conducted on four real-world traffic datasets using diverse noisy and missing scenarios, the proposed RT-GCN model has demonstrated its ability to handle noise perturbations and missing values and provide high accuracy prediction.*

交通预测在智能交通系统（ITS）中的智慧城市中发挥着至关重要的作用。旅行者以及城市管理者依赖可靠的交通信息来进行路径选择和交通管理的决策。然而，嘈杂或缺失的交通数据对于准确和稳健的交通预测构成了问题。虽然数据驱动模型，如深度神经网络，可以在完整数据集上实现高预测准确度，但传感器故障和环境影响降低了这些模型的性能，因为这些模型在模型训练和估计中严重依赖精确的交通测量。因此，不完整的交通数据对于设计鲁棒模型提出了挑战，该模型可以在嘈杂/缺失数据的情况下进行准确的交通预测。本研究提出了Robust Spatiotemporal Graph Convolutional Network（RT-GCN），这是一种交通预测模型，利用高斯分布的节点表示和基于方差的注意机制来处理噪声扰动和缺失数据。通过在四个真实交通数据集上进行的实验证明，所提出的RT-GCN模型展示了其处理噪声扰动和缺失值的能力，并提供了高准确度的预测。



## 一、介绍

*Traffic forecasting is a crucial aspect of intelligent transportation systems (ITS) as it enables both travelers and network managers to make informed decisions and manage traffic effectively. Over the past decades, the development of big data and computational techniques has led to a shift in traffic prediction models from statistical theory-driven methods such as the Kalman filter method [1] and autoregressive integrated moving average model (ARIMA) [2] to deep learning-based methods, those have emerged as the most widely used approaches in this category due to their strong predictive capabilities [3,4]. More recently, graph convolutional networks (GCN) have gained popularity in traffic prediction as they can capture the topological structure of transportation networks, which leads to higher prediction accuracy [5–7].*

*Recent studies have also used temporal convolution networks (TCN) [8, 9] or combinations of GCNs with time series neural networks such as recurrent neural networks (RNN) [10], long-short term memory neural networks (LSTM) [11], and gated recurrent units (GRU) [12] to extract spatiotemporal features from traffic data.*

交通预测是智能交通系统（ITS）中至关重要的一部分，因为它使旅行者和网络管理人员能够做出明智决策并有效地管理交通。在过去几十年里，大数据和计算技术的发展导致了交通预测模型的转变，从统计理论驱动的方法（如卡尔曼滤波器方法[1]和自回归积分移动平均模型（ARIMA）[2]）转向基于深度学习的方法，由于其强大的预测能力，后者已成为该类别中最广泛使用的方法[3,4]。近年来，图卷积网络（GCN）在交通预测中也变得流行起来，因为它们能够捕捉交通网络的拓扑结构，从而提高预测准确性[5–7]。

最近的研究还使用了时态卷积网络（TCN）[8, 9]或GCN与时间序列神经网络（如循环神经网络（RNN）[10]、长短时记忆神经网络（LSTM）[11]和门控循环单元（GRU）[12]的组合，以从交通数据中提取时空特征。

*Although deep learning models have shown remarkable performance in traffic prediction, they can be susceptible to inefficiencies due to over/under-fitting, noise, and data shortages. For example, when the data is insufficient or corrupted, the model’s performance can significantly deteriorate. Noisy and missing traffic information are inevitable due to various factors, such as sensor malfunction and environmental influences such as damage to loop detectors, bad weather, and data management platform failure [13]. Recent studies have shown that neural networks are vulnerable [14,15], even slight data perturbations would significantly degrade the performance of GCN [16]. Any model whose results are sensitive to slight changes in the dataset has limited value. Implementing deep learning methods for traffic prediction in the real world requires models that are not only accurate on clean datasets but also stable when dealing with naturally occurring corruptions. A robust traffic prediction model is still a challenge, and previous works have shown that there is a trade-off between accuracy and robustness [17]*

尽管深度学习模型在交通预测中表现出色，但它们可能会因过度/不足拟合、噪声和数据不足而变得不够高效。例如，当数据不足或受到损坏时，模型的性能可能会显著下降。由于各种因素，如传感器故障、环境影响（如线圈检测器损坏、恶劣天气）和数据管理平台故障[13]，交通信息中的噪声和缺失是不可避免的。最近的研究表明神经网络是脆弱的[14,15]，即使是轻微的数据扰动也会显著降低GCN的性能[16]。对于对数据集轻微变化敏感的任何模型，其实用价值受到限制。在真实世界中应用深度学习方法进行交通预测需要模型不仅在干净的数据集上准确，而且在处理自然发生的数据破坏时也要稳健。

构建一个稳健的交通预测模型仍然是一个挑战，先前的研究表明准确性与稳健性之间存在权衡[17]。

*Robust prediction refers to the ability to resist noise and perturbations in the input data while predicting future traffic states [18]. In light of this, many researchers preprocess the input data (i.e. noisy and missing data handling) separately from the model training process. For instance, smoothing methods are employed to clean anomalies in traffic flow data [19], filling methods based on trend-historical data are used to reconstruct missing data [20,21], and data infer algorithms [22,23] are utilized to impute missing data. Some other researchers have proposed tailoring deep learning models to incorporate the imputation mechanism into prediction tasks [24–29]. However, data imputation methods have the potential to disrupt crucial latent features, thereby compounding the problem of error accumulation. The generative adversarial network (GAN) based data augmentation method has also been applied in traffic prediction fields, providing an alternative to the data shortage problem [30,31]. Implementing these intelligent methods often requires large computing resources to train the model, leading to suboptimal analysis and forecasting.*

鲁棒预测指的是在预测未来交通状态时，能够抵抗输入数据中的噪声和扰动的能力[18]。基于这一观点，许多研究人员通常将输入数据的预处理（即处理噪声和缺失数据）与模型训练过程分开。

例如，使用平滑方法来清除交通流数据中的异常值[19]，基于趋势历史数据的填充方法用于重构缺失数据[20,21]，并利用数据推断算法[22,23]来填补缺失数据。一些研究人员提出了调整深度学习模型，将插值机制纳入到预测任务中[24–29]。然而，数据插补方法有可能破坏关键的潜在特征，从而加剧误差累积问题。基于生成对抗网络（GAN）的数据增强方法也被应用于交通预测领域，为解决数据不足问题提供了一种替代方案[30,31]。然而，实施这些智能方法通常需要大量的计算资源来训练模型，导致分析和预测的次优性。

*In recent years, Bayesian neural networks (BNN) have been employed as promising approaches to address the challenges arising from noisy and sparse traffic data. These studies have demonstrated their value in mitigating these issues and improving the quality of analysis and predictions in the context of traffic analysis [27,32–34]. Nevertheless, when applying BNN for traffic flow prediction with missing data, certain limitations arise. Firstly, BNNs do not inherently deal with missing data, necessitating additional preprocessing steps like imputation techniques or explicit handling of missing values, which introduce complexity and potential biases. Moreover, structural learning in BNN in the presence of missing data can be problematic and can significantly impact the constructed network and thus prediction accuracy.*

*Therefore, developing an inherently robust traffic prediction model and avoiding complex imputation or preprocessing in the presence of abnormal or missing traffic data remains a highly challenging yet significant research problem.*

最近，贝叶斯神经网络（BNN）作为解决嘈杂和稀疏交通数据带来挑战的有效方法被应用。这些研究表明了它们在缓解这些问题、提升交通分析和预测质量方面的价值[27,32–34]。然而，将BNN用于具有缺失数据的交通流量预测时，会出现一些限制。首先，BNN并不固有地处理缺失数据，需要额外的预处理步骤，如插值技术或显式处理缺失值，这会引入复杂性和潜在的偏差。此外，在存在缺失数据的情况下，BNN中的结构学习可能会出现问题，显著影响构建的网络，从而影响预测准确性。

因此，在异常或缺失交通数据存在的情况下，开发一个固有鲁棒的交通预测模型，并避免复杂的插值或预处理，仍然是一个极具挑战性但又非常重要的研究问题。

*To this end, the authors propose a novel model named Robust Spatiotemporal Graph Convolutional Network (RT-GCN) to predict traffic flow. The RT-GCN is a combination of a variant GCN and GRU models, which can capture the spatiotemporal dependence of traffic data and improve predictive robustness while maintaining accuracy and efficiency. Specifically, rather than representing the hidden states by plain vectors, Gaussian distributions are used to represent the hidden states in the GCN and GRU layers. The motivation for this work is that the Gaussian distribution for hidden representation in the network could potentially negate the effects of noise and data corruption. Additionally, a variance-based attention mechanism is introduced to reduce the propagation of information from perturbed data. Specifically, large weights are assigned to the hidden state with small variance and small weights are assigned to the hidden state with large variance to prevent the impact of abnormal or missing data from propagating to other nodes and time stamps. Furthermore, an additional training strategy called Batch Random Noise, inspired by the notion of ‘‘data augmentation’’ [35,36], is incorporated to further enhance the robustness of our model. This strategy introduces on-the-fly random noise to each batch of input data, resulting in an augmented dataset that represents a more comprehensive set of possible perturbed data. To evaluate the performance of the model, extensive experiments are conducted utilizing four real-world datasets, consisting of two raw and two trained clean datasets. Acknowledging the complexity of missing patterns in real-world transportation systems, such as time-consecutive or spatially correlated patterns, distinct types of missing patterns with varying ratios of corrupted data are also considered during the evaluation process. The results show that RT-GCN maintains stable prediction performance especially when the amount of abnormal and missing data is high.*

为此，作者提出了一种名为Robust Spatiotemporal Graph Convolutional Network（RT-GCN）的新型模型，用于预测交通流量。RT-GCN是GCN和GRU模型的组合变体，可以捕捉交通数据的时空依赖关系，提高预测的鲁棒性，同时保持准确性和效率。具体而言，与仅使用普通向量表示隐藏状态不同，GCN和GRU层中使用高斯分布来表示隐藏状态。这项工作的动机在于，网络中对隐藏表示采用高斯分布可能有助于抵消噪声和数据损坏的影响。此外，引入了一种基于方差的注意机制，以减少对受扰动数据的信息传播。具体而言，给具有小方差的隐藏状态分配大权重，给具有大方差的隐藏状态分配小权重，以防止异常或缺失数据的影响传播到其他节点和时间戳。此外，还引入了一种名为Batch Random Noise的附加训练策略，灵感来自“数据增强”[35,36]的概念，以进一步增强我们模型的鲁棒性。该策略对每个输入数据批次引入即时的随机噪声，从而生成一个更全面的可能受扰动数据集。为了评估模型的性能，进行了大量实验，利用包括两个原始和两个经过训练的干净数据集在内的四个真实世界数据集。在评估过程中，考虑到实际交通系统中缺失模式的复杂性，如时间连续或空间相关模式，还考虑了不同类型的缺失模式，具有不同比例的受损数据。结果表明，RT-GCN在异常和缺失数据量较大时仍能保持稳定的预测性能。