# Residual attention enhanced Time-varying Multi-Factor Graph Convolutional Network for traffic flow prediction 

用于交通流量预测的残差注意力增强时变多因素图卷积网络

单位： 南通大学信息科学与技术学院，中国南通，226019

期刊：Engineering Applications of Artificial Intelligence  IF：7.5  Q1

## 摘要

准确且及时的交通流量预测对于缓解交通拥堵具有重要意义。尽管图卷积交通流量预测方法已取得了一定成效，但在全局空间特征提取和外部因素考量方面仍有改进的空间。

为应对这一挑战，本文提出了一种新颖的残差注意力增强时变多因素图卷积网络（RTM - GCN）。RTM - GCN 包含一个多因素图卷积模块、一个空间增强模块和一个时变模块。

首先，构建一个==多因素矩阵来考量影响交通流量的内外部因素==，该==矩阵分为包含节点距离和数据相关性的内部因素矩阵以及包含天气和新闻的外部因素矩阵==。

其次，构建一个多因素图卷积模块用于提取多因素矩阵的局部空间特征。

然后，采用一种基于残差卷积运算和自注意力门控线性单元的新型空间增强模块来增强全局空间特征。

最后，构建一个基于扩张因果卷积的时变模块来增强长期时间特征并输出最终预测值。

与现有最先进的模型相比，RTM - GCN 模型在五个真实世界数据集上使均方根误差（RMSE）降低了 6.362%。关键源代码和数据可在https://github.com/Bounger2/RTMGCN获取。

## 一、简介

交通拥堵一直是城市发展中的关键问题之一（巴伊拉卡塔尔等人，2023年）。由于缺乏实时交通流量引导，出行者往往凭借自身的经验和知识来规划行程，这就导致了不可避免的拥堵（门德斯等人，2023年）。随着人工智能在信息采集技术方面的发展，构建高效、实时且准确的交通流量预测模型成为了可能（帕穆拉和佐霍夫斯卡，2023年）。 交通流量预测是智能交通系统（ITS）的一个重要组成部分，它能够减少交通拥堵并提高出行效率（徐等人，2023年）。因此，针对实际路况提高交通流量预测模型的精度一直是当前学者们关注的问题。

随着深度学习理论的发展，数据驱动方法中的深度学习技术已逐渐成为主流（肖等人，2023年；谢等人，2019年）。与卷积神经网络（CNNs）相比，图神经网络（GNNs）能更好地应用于非欧几里得数据或不规则数据，并且在现实世界的交通流量预测任务中得到了广泛应用（陈等人，2022年；程等人，2022年）。图卷积网络（GCNs）作为图神经网络的简化版本被广泛使用（李等人，2023年）。赵等人（2020年）成功地将图卷积网络与门控循环单元（GRU）相结合，实现了对交通流量时空特征的提取。 然而，现实世界中交通流量的时空变异性以及诸如地理位置、天气、新闻等多种因素一直使得交通流量预测颇具挑战性（张等人，2022年）。首先，历史交通状况和周边交通状况会影响预测区域内的交通状况，导致交通流量在时空特征上呈现出不同的趋势（赵等人，2023年）。其次，==地理位置（市中心和郊区）、天气（晴天和暴风雨天气）、新闻（体育赛事和节假日安排）等因素==会对交通流量产生不同的影响（陈等人，2020a），如图1所示。因此，在预测模型中考虑各种因素的相关性至关重要。 目前基于图卷积网络的交通流量预测模型通常侧重于改进对时间特征的提取（宋等人，2020年；王等人，2022年）。其差异在于优先提取时间特征还是空间特征，或者是同时提取两者，但很少考虑外部信息对交通流量的影响，这使得在天气或新闻影响下衡量交通流量的非周期性变化颇具难度。

图卷积网络（GCN）通常通过堆叠多次操作来学习相邻节点的特征。然而，**由于梯度消失问题，GCN的堆叠最多只能达到3到4层，这导致其全局特征学习能力下降（赵等人，2020年）**。作为图神经网络（GNN）的重要变体之一，**图采样与聚合（GraphSAGE）可以通过邻居采样和特征聚合等操作实现全局特征提取，但样本数量的限制可能会导致一些节点的重要局部信息丢失（**黄等人，2023年）。**刘等人（2023年）使用时空GraphSAGE模块从节点邻居的过往观测中提取局部相关性**。 此外，由于图神经网络的输入是无序的，它通常依靠邻接矩阵等关系矩阵来明确节点的连通性，这将直接丢失节点在地图上的真实位置分布及其相互影响特征。与图卷积网络不同，卷积神经网络（CNN）可以直接保留节点的真实位置分布以进行特征提取，从而能够有效地实现全局特征的精简与提取（李等人，2023年）。 因此，==如何构建一个有效的全局特征提取模块并全面考虑外部信息对交通流量的影响==，是本文着重解决的问题。

为克服上述挑战，本文提出了一种新颖的残差注意力增强时变多因素图卷积网络（RTM - GCN）。RTM - GCN由一个==多因素图卷积模块、一个空间增强模块和一个时变模块==组成。==多因素图卷积模块实现了交通流量内外部信息的联合提取==，==空间增强模块实现了全局特征信息的补充==，==时变模块实现了长期时间特征的提取==。本文在以下几个方面做出了具体贡献：

+ 提出了==多因素图卷积模块==。==内部因素矩阵是基于节点的经纬度和历史数据生成的==。==外部因素矩阵是基于道路网络所在位置的天气状况和新闻生成的==。本文利用全连接网络来学习内部因素矩阵和外部因素矩阵的贡献，并通过双层图卷积来获取交通图特征的局部空间特征。
+ 多因素图卷积模块能很好地提取交通流量的局部空间特征，但难以捕捉全局特征。鉴于卷积神经网络（CNN）在栅格网络（raster networks,）中出色的全局特征提取能力，本文设计了一个==基于残差卷积网络的空间增强模块来捕捉全局空间特征==，并利用==自注意力门控线性单元将全局空间特征融入多因素图卷积模块的输出结果中==。本文还构建了一个==基于二维扩张因果卷积的时变模块，用于挖掘长期时间特征==并输出预测结果。
+ 已使用五个真实世界的数据集对RTM - GCN模型的性能进行了评估。实验结果表明，RTM - GCN在提取全球时空特征以及对特殊事件的敏感度方面展现出了卓越的能力。与现有最先进模型的均方根误差（RMSE）相比，RTM - GCN的预测性能降低了6.362%（此处表述有误，应该是提高了，因为性能更好意味着误差降低，通常是说比其他模型的误差降低了多少来体现性能优势，按照正常理解推测原文可能是想说“降低了6.362%的均方根误差”之类的意思）。

本文其余部分的结构如下：在第2节中，对现有的交通流量预测方法进行了综述。第3节介绍了交通流量预测的基本概念。 第4节概述了RTM - GCN方法。第5节涵盖了实验设置、结果、讨论以及未来展望。最后，在第6节中对本文进行了总结。

## 二、相关工作

### 2.1 不使用GCN的交通流预测

### 2.2 使用GCN的交通流预测

表1梳理了当前基于图卷积网络（GCN）的主流交通流量预测方法，从中可以发现以下不足之处：1）大多数模型没有考虑诸如天气和新闻等对交通流量有重要影响的因素。2）==图卷积网络（GCN）的输入是无序的，这可能会导致道路网络节点的空间分布信息丢失，进而造成全局特征的缺失==。 与上述模型不同的是，1）本文提出的RTMGCN模型通过构建内外部因素矩阵来考量交通流量距离、数据相关性、外部天气以及新闻等因素对每个节点的影响，充分考虑了这些因素的作用。2）残差卷积模块的融入有效地增强了模型对全局动态空间特征的学习能力，并提高了其在复杂多样环境下的时空表达能力。

![image-20241026200325652](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410262003806.png)

## 三、预备知识

### 3.1 问题定义

**定义1** ：

交通图网络：定义一个无向图$G = (V, E, A)$来描述交通图网络，如图2a所示。$V$和$E$分别代表节点集和边集，且$\vert V\vert = N$。 $A\in\mathbb{R}^{N\times N}$是邻接矩阵，用于表示节点之间的连通性。在图$G$中，每个节点以相同的频率收集$T_{H}$个历史数据点。$h_{n,t}$表示在时刻\(t\)在节点$n$处收集到的交通数据（流量、速度和占有率），其中$n\in N$且$t\in T_{H}$（赵等人，2020年）。交通图特征\(H\)定义如下：

![image-20241026200958033](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410262009079.png)

交通图网络预测问题被定义为：利用输入特征$H_{In}\in\mathbb{R}^{N\times L}$来预测特征$H_{Out}\in\mathbb{R}^{N\times\Delta T}$，其中$L$表示历史序列的长度，$\Delta T$表示预测序列的长度。

![image-20241026200554884](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410262005079.png)

**定义2：**

交通栅格网络：交通栅格网络被定义为$S$，其结构如图2b所示。能够容纳所有节点的栅格网络的长度被定义为$M$，且$S\in\mathbb{R}^{M\times M}$。 对于每个栅格单元$S_{m,n}$，它们在空间中以恒定的相邻距离均匀分布，其中$m,n\in M$。$R$中的数据采集间隔与$G$中的相同，并且$r_{m,n}^{t}$表示在时刻$t$位置$(m,n)$的交通状态。$h_{n,t}$表示一个节点的交通状态，而$r_{m,n}^{t}$则表示区域$(m,n)$内所有节点的总体状态（何等人，2023年）。在本研究中，一个区域的整体交通状态通过节点流量之和来体现。时刻$t$的交通栅格特征，记为$R_{t}$，其定义如下：

![image-20241026201712790](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410262017846.png)

交通栅格网络预测问题被定义为：利用输入特征$R_{In}\in\mathbb{R}^{M\times M\times L}$来预测特征$R_{Out}\in\mathbb{R}^{M\times M\times\Delta T}$。 基于所给定的定义，可以看出交通图网络侧重于预测单个节点的特征，而交通栅格网络则侧重于预测区域的特征。与前者相比，后者具有能更好地提取交通流量全局空间特征的优势。

### 3.2 交通流的全局空间特征和外部特征

图卷积运算被广泛用于从非欧几里得结构的交通网络中提取特征，如图1a所示。通过进行多次图卷积操作，目标节点能够逐层学习其相邻节点的特征，从而实现局部空间特征的提取。对每个节点有效地提取局部特征对于实现全局特征学习至关重要。然而，基于图卷积的方法侧重于挖掘节点之间的特征传递，而忽略了非节点区域的特征变化。图1b展示了通过卷积运算提取交通栅格网络空间特征的过程。==卷积方法侧重于挖掘区域空间特征，这使得反映全局空间特征的变化更加容易==。 除了全局空间特征外，考虑外部因素同样重要。图卷积方法在提取节点特征时忽略了外部天气和新闻等因素的影响，导致在节点之间的传递过程中缺乏外部因素的信息干预，如图1c所示。因此，==本文的重点是利用交通栅格网络的全局空间特征来增强交通图网络，并在外部因素影响下提取时空特征==。

> CNN比GCN更好的捕捉全局空间特征



## 四、RTM-GCN

### 4.1 RTM-GCN概述

![image-20241026211824072](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410262118263.png)

在本文中，为解决这一问题，提出了一种新颖的RTM - GCN模型。如图3所示，RTM - GCN模型由多因素图卷积模块、空间增强模块和时变模块组成。==多因素图卷积模块用于提取内外部因素的空间特征==；==空间增强模块用于输出全局空间特征以增强多因素图卷积==；==时变模块用于增强长期时间特征并避免丢失历史信息==。该模型的最终预测输出由时变模块获得。通过融合交通栅格网络的全局空间特征，RTM - GCN对交通图网络进行了增强，这对于提高交通流量全局特征的提取起到了重要作用。

### 4.2 多因素图卷积模块

如图2所示，交通流量受多种因素影响。为了更好地衡量多种因素对交通流量的干扰，本文建立了一个内外部因素矩阵。==内部因素矩阵（包括距离度量矩阵和数据相关性矩阵）是基于节点的经纬度和历史数据生成的==。==外部因素矩阵（包括天气度量矩阵和新闻度量矩阵）是基于道路网络所在位置的天气状况和新闻生成的==。在本研究中，使用一个全连接网络来学习内部因素矩阵和外部因素矩阵的贡献，以取代经典的邻接矩阵。此外，还利用一个两层的图卷积网络（GCN）来获取交通图特征的局部空间特征。多因素图卷积模块的处理流程如图4所示。

![image-20241026220234333](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410262202468.png)

#### 4.2.1 内部因素矩阵

内部因素矩阵包括距离度量矩阵$I_D$和数据相关性矩阵$I_C$。距离度量矩阵$I_D$的构建过程如下： 节点之间的距离会影响交通流量的相关性。 一般来说，节点之间相距越远，它们之间的相关性就越小；反之，距离越近，相关性就越大。基于经纬度，我们利用考虑到地球曲面的哈弗辛公式（定义如下）来计算传感器节点\(i\)和传感器节点\(j\)之间的物理距离：

![image-20241026221353460](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410262213522.png)

其中$\theta = d/R$，$d$是传感器节点$i$和传感器节点$j$之间的距离，$R$是地球半径，设定为$6371$千米；$Lat(i)$和$Lat(j)$分别代表传感器节点$i$和传感器节点$j$的经度，$Lon(i)$和$Lon(j)$分别代表传感器节点$i$和传感器节点$j$的纬度；$Hav(\theta) = (1 - \cos(\theta)) / 2$。基于此公式，可以得出所有节点之间的物理距离。 设定一个距离阈值$\alpha$。如果传感器节点$i$和传感器节点$j$之间的距离$d_{ij}$大于$\alpha$，那么$I_D(i, j) = 0$；否则，其值等于$1$。距离度量判别公式如下：

![image-20241026221647592](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410262216642.png)

根据上述提到的距离度量判别公式，可以生成一个距离度量矩阵$I_D\in\mathbb{R}^{N\times N}$。

数据相关性矩阵$I_C$的构建过程如下：

节点的数据之间存在相关性。如果传感器节点$i$和传感器节点$j$的交通流量信息变化趋势相似，这就表明这两个节点的交通流量信息具有高度相关性。因此，本文建立了一个数据相关性矩阵来反映节点之间的这种相关性。皮尔逊相关系数被广泛用于衡量两个时间序列数据的连通性（贝内斯蒂等人，2009年），其定义如下：

![image-20241026223344349](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410262233429.png)

其中，$Mean(\cdot)$和$STD(\cdot)$分别是计算均值和标准差的运算。$h_{i,t}$表示传感器节点$i$在时刻$t$的交通流量信息。$Pea(i, j)$输出两个节点之间的相关性度量值，其取值范围是$(-1, 1)$。数值越接近$1$或$-1$，当时的正相关或负相关性就越强。基于此公式，本文获得了所有节点的相关性度量，并生成了一个数据相关性矩阵$I_{C}\in\mathbb{R}^{N\times N}$。

#### 4.2.2 外部因素矩阵

外部因素矩阵包括天气度量矩阵$E_W$和新闻度量矩阵$E_N$。天气数据和新闻数据对交通流量信息至关重要。恶劣天气会降低人们的出行意愿，而城市马拉松赛事新闻或区域道路维修信息能提醒人们改变路线或不出行。这两种情况都会导致交通流量出现非周期性变化。天气数据和新闻数据对传感器节点$i$和传感器节点$j$的交通流量信息的影响属于文本数据范畴的外部干扰因素，对其进行数值量化十分必要。 

本文采用独热编码（one-hot）方法对天气和新闻数据对出行的影响进行编码。以天气数据为例，根据天气状况将传感器节点$i$和传感器节点$j$之间的出行意愿编码为长度为$3$的向量，比如[出行舒适、出行正常、出行困难]。如果天气状况使得人们在传感器节点$i$和传感器节点$j$之间出行困难，那么此时的==编码特征$En_{We}(i, j)$就是[0, 0, 1]。如果天气的解码矩阵定义为$W_{We} = [0.9, 0.5, 0.1]$==，那么通过对矩阵进行转置操作（用\(Tr\)表示转置），利用$En_{We} W_{We}^{Tr}$就可以得到传感器节点$i$和传感器节点$j$之间具体的天气度量值为$0.1$。 

按照上述方法，本文能够生成所有节点之间的天气度量矩阵$E_W\in\mathbb{R}^{N\times N}$。新闻度量矩阵\(EN\)的获取方式与天气度量矩阵相同。通过定义相应的编码特征$E_N$和解码矩阵$W_N$，就可以输出所有节点之间的新闻度量矩阵$E_N\in\mathbb{R}^{N\times N}$。

> N x N ?
>
> 时间因素呢？

> 编码 解码？
>
> 编码：将非数值型数据编码为数值
>
> 解码：将已经编码的信息转化为对特定场景下的**数值影响**

> 就是外部特征（新闻：节假日，演唱会等），内部特征（距离，数据相关性，皮尔森相关系数）的预处理

#### 4.2.3 多因素特征融合提取

基于经典邻接矩阵难以有效度量节点间动态关系特征这一情况，本文提出了一种多因素融合特征$A_F$，它是通过基于全连接网络融合内外部因素矩阵的特性而得到的。与邻接矩阵不同的是，$A_F$能够有效度量多种因素的影响，从而更好地反映节点之间的相互关系。具体操作如下：

![image-20241027113348247](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271133334.png)

其中，$FC(\cdot)$表示全连接操作，$f_{AF}$表示激活函数。==考虑到图卷积网络在交通图网络中的出色表现，本文使用一个两层的图卷积网络（GCN）对$H_{In}\in\mathbb{R}^{N\times L}$进行初步的空间特征提取==。具体操作如下：

![image-20241027113614568](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271136631.png)

其中，$X^{l + 1}_{2GCN}$和$X^{l}_{2GCN}$分别表示第$l$层双层图卷积操作的输入和输出，$W^{1}_{2GCN}$和$W^{2}_{2GCN}$是双层图卷积第一层和第二层的权重。最后，我们得到用于多因素空间特征的输出$H_{S1}\in\mathbb{R}^{N\times L}$。

> 多因素特征融合提取：
>
> 融合：把所有的内部特征和外部特征矩阵 全连接，然后加起来，激活函数
>
> 提取：L层双层图卷积。 原因：考虑到图卷积网络在交通图网络中的出色表现，本文使用

### 4.3 空间增强模块

![image-20241027133614433](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271336663.png)

如第3.2节所述，增强图卷积的全局空间特征提取能力对于提高交通流量预测的性能至关重要。如图5所示，本文提出了一种新颖的空间增强模块来增强图卷积的全局空间特征。该空间增强模块由残差卷积网络和自注意力门控线性单元组成。 

==鉴于卷积神经网络（CNN）在交通栅格网络中出色的全局空间特征提取能力==，本文==构建了一个残差卷积网络来提取全局空间特征==（罗等人，2022年）。该==残差卷积网络包括三维卷积操作和残差==操作，其中三维卷积操作定义如下：

![image-20241027133800602](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271338661.png)

其中，$X_{l}^{3DConv}$和$X_{l + 1}^{3DConv}$分别是第$l$层卷积操作的输入和输出，$W_{l}^{3DConv}$是第$l$层卷积操作的权重。为了避免梯度消失并捕捉局部变化对数据的影响，引入了残差操作来对上述操作进行如下更新：

![image-20241027164429066](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271644139.png)

残差卷积网络的最终输出是$R_{RC}\in\mathbb{R}^{M\times M\times L}$。 

==为了将残差卷积网络输出的全局空间特征$R_{RC}$应用到每个节点上，构建了一个全局空间特征提取器。根据节点编号对栅格数据$R_{RC}$进行遍历，并基于交通特征矩阵$H$的节点顺序来获得全局空间特征$H_{G}\in\mathbb{R}^{N\times L}$==。

> 全局空间特征提取器：
>
> ​	没看明白，看看代码

**自注意力门控线性单元**旨在更好地整合多因素空间特征$H_{S1}$和全局空间特征$H_{G}$的贡献，其运算定义如下：

![image-20241027164652550](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271646612.png)

其中，$H_{S2}\in\mathbb{R}^{N\times L}$是空间特征增强后的输出，$f_{Att}$是一种自注意力操作，$\otimes$是哈达玛积（Hadamard product），$\sigma$是S型激活函数（sigmoid activation function），$Tr$是转置操作。

### 4.4 时变模块

![image-20241027191627548](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271916679.png)

空间增强模块有效地提高了对全局空间特征的提取能力，但忽略了提取长期时间特征的能力。==扩张因果卷积已被证明在提取长期时间特征方面具有良好性能，但它主要用于一维时间序列数据的提取==。如图6所示，==本文提出了一种二维扩张因果卷积网络来探究交通图的长期时间特征==。扩张因果 卷积运算定义如下：

![image-20241027185728775](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271857836.png)

其中，$X^{l + 1}_{TCN}$和$X^{l}_{TCN}$分别是第$l$层扩张因果卷积的输出和输入。$W^{l}_{TCN}$和$b^{l}_{TCN}$分别是扩张因果卷积的权重和偏置项。给定输入$X^{l}_{TCN} \in \mathbb{R}^{N\times L}$，其中扩张率设置为$1\times\gamma$，通过多次卷积操作，最终的预测输出为$Y_{P}\in\mathbb{R}^{N\times K}$，其中$K$是待预测序列的长度。均方误差（Mean Squared Error，MSE）被用作损失函数来训练RTM - GCN：

![image-20241027191241465](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271912528.png)

其中，$Y_{R}$和$Y_{P}$分别是交通流量的真实值和预测值，$p$是交通流量训练样本的数量。该模型的具体训练过程如算法1所示。

![image-20241027191354392](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410271913489.png)



## 五、实验

### 5.1 数据集

本文使用了五个数据集：PeMS03、PeMS04、PeMS07、PeMS08 和 SZ - TAXI。

PeMS（03 - 08）：性能测量系统（PeMS）数据集提供了由美国加利福尼亚州交通运输部（Caltrans）在加利福尼亚州高速公路上收集的统一交通数据数据库。PeMS（03 - 08）的数据采集间隔为 5 分钟。本文主要将 PeMS（03 - 08）的交通流量用作测试数据（宋等人，2020 年）。

SZ - TAXI：该数据集是从中国深圳的出租车数据中收集而来。记录的时间间隔为 15 分钟，数据代表交通速度（赵等人，2020 年）。

![image-20241027205303778](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410272053859.png)

表 2 提供了这五个数据集的具体描述。道路节点的经纬度、天气状况和新闻事件对模型的准确性至关重要。本文从 “https://pems.dot.ca.gov/” 获取节点经纬度数据，从 “http://tianqi.2345.com/” 获取天气信息，根据节点位置信息从 “https://www.google.com/” 获取新闻事件（节假日和交通事故）。在获取天气和新闻数据后，本文将它们转换为类似于邻接矩阵的外部因素矩阵，以反映每个节点之间的天气和新闻度量。具体而言，==本文将天气和新闻的度量权重都设置为 [0.9, 0.5, 0.1]，并且外部因素矩阵的时间间隔与数据集中交通数据的间隔一致==。天气和新闻对应的具体值如表 3 所示。

![image-20241027205246743](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410272052830.png)

在收集完所有必要数据后，在进行标准化之前进行了预处理，以避免出现缺失值或冗余值。

### 5.2 实验设置

#### 5.2.1 超参数设置

本文使用深度学习框架PyTorch来实现RTM - GCN及其他深度学习模型。实验是在配备NVIDIA RTX 3080显卡、英特尔i7 - 12700处理器以及Windows 11操作系统的系统上进行的。对于RTM - GCN采用了Adam优化器。RTM - GCN的最大训练迭代次数设置为800次，初始学习率为0.0001，批量大小为30。在5.1节中，训练集和测试集的划分比例为7 : 3。在模型训练过程中，本文将测试集等同于验证集用于性能验证。表4展示了RTM - GCN的其他重要参数。

![image-20241027215551540](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410272155623.png)

#### 5.2.2 基准模型

本研究选取了十四种对比模型，具体如下： 

a) ARIMA：自回归移动平均求和模型（Auto-Regressive Integrated Moving Average model）是一种用于预测任务的经典时间序列分析方法（丁等人，2018年）。 

b) LSTM：通过对循环神经网络（RNN）模型进行改进，有效减少了梯度消失或梯度爆炸情况的发生，长短期记忆网络（LSTM）可用于提取时间特征（霍赫赖特和施密德胡贝，1997年）。 

c) CNN：卷积神经网络（CNN）模型使用常规卷积核对欧几里得结构的空间特征进行提取（程等人，2022年）。 

d) DCRNN：扩散卷积循环神经网络（DCRNN）模型采用双向随机游走对空间依赖性进行建模，并利用编解码器架构对时间依赖性进行建模（李等人，2018年）。 

e) STGCN：时空图卷积网络（STGCN）模型使用图卷积网络（GCN）提取空间特征，并用一维卷积神经网络（1D-CNN）提取时间特征（于等人，2018年）。 

f) ASTGCN：自适应时空图卷积网络（ASTGCN）模型利用时空注意力机制来提取多周期时空特征（郭等人，2019年）。 

g) STSGCN：时空同步图卷积网络（STSGCN）模型设计了一种时空同步建模机制，以捕捉复杂的局部时空相关性（宋等人，2020年）。 

h) STFGNN：时空特征生成神经网络（STFGNN）模型提出了一种数据驱动的方法来生成“时间图”，以弥补空间图可能未反映出的相关性（李和朱，2021年）。 

i) Auto-DSTSGN：自动深度时空同步图生成网络（Auto-DSTSGN）模型提出了一个自动深度时空同步图（Auto DSTSG）模块，通过按递增顺序堆叠带有扩张因子的更深层来捕捉短期和长期时空相关性（金等人，2022年）。 

j) MVSTT：多视图时空转换（MVSTT）模型从三个视角学习时空特征，并将基于图神经网络（GNN）的模块与转换器相结合，用于时空信息融合（浦等人，2022年）。 

k) MD-GCN：多尺度图卷积网络（MD-GCN）模型使用门控时间卷积结合GraphSAGE和多尺度图卷积网络（MGCN）来提取交通流量的全局和局部相关性（黄等人，2023年）。 

l) DST-GraphSAGE：时空GraphSAGE模型使用时空GraphSAGE模块结合注意力机制和扩张因果卷积来提取交通流量的局部和长期时空特征（刘等人，2023年）。 

m) GMAN：图注意力网络（GMAN）模型利用空间和时间注意力机制对空间和时间相关性进行建模，以便更好地进行长期预测（郑等人，2022年）。 

n) TFormer：变换器模型（TFormer）基于全局编码器和全局局部解码器来提取全局和局部空间特征（阎等人，2022年）。 

ARIMA是一种用于时间序列预测的典型模型驱动方法，而LSTM和CNN是两种用于单一特征提取的典型深度学习方法。DCRNN、STGCN、ASTGCN、STSGCN、STFGNN、AutoDSTSGN、MVSTT是基于图神经网络（GNN）的较为流行的交通流量预测模型。MD-GCN和DST-GraphSAGE是融合了GraphSAGE模块的交通流量预测模型。GMAN和TFormer是融合了Transformer模块的交通流量预测模型。选择上述五类对比模型类别是为了更好地展示RTM - GCN模型在各个领域的优势。

#### 5.2.3 评价标准

本文在交通流量预测任务中使用了三种常用的评估指标，即均方根误差（Root Mean Square Error，RMSE）、平均绝对误差（Mean Absolute Error，MAE）和平均绝对百分比误差（Mean Absolute Percentage Error，MAPE），来评估所提出模型的预测准确性。这三种评估指标的计算公式如下：

![image-20241027220916407](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410272209479.png)

除了用于评估预测准确性的三个指标外，还分别使用参数量（Params）和浮点运算次数（FLOPs）来评估模型的空间复杂度和时间复杂度。参数量和浮点运算次数通常用于衡量模型的空间占用情况和时间效率，其值越低越好。

#### 5.2.4 交通栅格特征构建

对于能够收集到节点经纬度的公开可用数据集，本文直接采用栅格划分的方式来构建交通栅格特征。根据节点的实际分布情况，将道路划分为大小相等的网格，每个栅格内交通流量统计值的总和就代表了该区域的交通状况。图7a展示了基于经纬度数据在栅格网络中PeMS03的所有节点分布情况。 对于难以获取经纬度数据的公开可用数据集，本文将节点按顺序排列，并将其组合成一个维度为$N×1×T_{in}$的三维张量作为输入，用于交通栅格特征提取，其中$T_{in}$是历史数据周期的长度。图7b展示了为未定位节点构建栅格特征的示意图。

![image-20241027221255788](https://raw.githubusercontent.com/Quinlan7/pic_cloud/main/img/202410272212926.png)

### 5.3 实验结果

#### 5.3.1  RTM-GCN 的预测性能

本文随机选取测试集中一个节点的预测结果来展示RTM - GCN的性能。RTM - GCN在PeMS（03 - 08）和SZ - TAXI数据集上的拟合情况如图8所示。 从图8a - d可以看出，PeMS（03 - 08）数据集存在明显的交通高峰和低谷，交通流量从凌晨4点开始逐渐增加，在上午8点30分左右达到第一个高峰，然后在下午6点左右下降。图8e展示了SZ - TAXI中一个七天测试集的速度拟合情况，其数据波动较大。 图8所示的拟合情况表明，本文提出的RTM - GCN能够很好地拟合长期交通数据，并且具有良好的预测性能。 本文展示了RTM - GCN在五个数据集内200次迭代的情况以验证其可扩展性。

如图9所示，RTM - GCN在第19次迭代之前收敛速度最快，在第19次到第86次迭代之间逐渐达到平稳状态，在第86次迭代之后基本平稳。 

新闻事件对交通流量的影响巨大。以PeMS03数据集中的节点#313487为例，2018年9月3日是周一，如图10b所示，正常情况下交通流量应该较高，但实际情况却相反，如图10a所示。本文通过挖掘新闻事件发现，9月3日是美国的劳动节，并且该地区还在进行紧急道路维修，导致与前几日相比交通趋势有所不同。本文提出的RTM - GCN通过挖掘节点的内外部因素特征来衡量节点所受到的干扰。图10c展示了RTM - GCN对节点#313487从2018年1月17日到11月23日的预测情况。可以看出，11月22日和11月23日的趋势与图10b不同，因为这两天是美国的感恩节，并且在11月23日，该节点附近还发生了一起交通事故。本文提出的模型能够在特殊事件下很好地拟合交通流量，具有良好的应用价值。

#### 5.3.2 RTM-GCN **与基线模型的性能比较**